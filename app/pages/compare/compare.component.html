<div mdl id="page-content-wrapper" class="mdl-grid">
    <h3 class="mdl-cell mdl-cell--12-col">Comparar Municípios</h3>
    <div class="error mdl-cell mdl-cell--12-col" *ngIf="errorMessage">{{errorMessage}}</div>

    <div class="mdl-cell mdl-cell--6-col">
        <h4 class="mdl-cell mdl-cell--12-col">Nome do município</h4>
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <input #buscaMunicipio1 class="mdl-textfield__input" type="text" id="sample3" [(ngModel)]=query (keyup)=filter()>
            <label class="mdl-textfield__label" for="sample3">Buscar município</label>
        </div>
        <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" (click)="getMunicipio1(buscaMunicipio1.value);"> 
            Buscar Município
        </button>
        <div class="suggestions" *ngIf="filteredList.length > 0">
            <ul *ngFor="let item of filteredList">
                <li>
                    <a (click)="select(item.nome)">{{item.nome}}</a>
                </li>
            </ul>
        </div>

        <div class="mdl-cell mdl-cell--12-col">
            <div id="detalhes-municipio" *ngIf="municipio1" class="mdl-cell mdl-cell--12-col">
                <div class="mdl-card card-left mdl-shadow--2dp mdl-cell mdl-cell--12-col">
                    <div class="mdl-card__title mdl-card--border">
                        <h2 class="mdl-card__title-text">Mapa da Região - {{municipio1.nome}}</h2>
                    </div>
                    <div class="mdl-card__supporting-text">
                        <sebm-google-map [latitude]="municipio1.latitude" [longitude]="municipio1.longitude" [zoom]="zoom">
                            <sebm-google-map-marker *ngFor="let m of markers" [latitude]="m.lat" [longitude]="m.lng" [label]="m.label"></sebm-google-map-marker>
                        </sebm-google-map>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="mdl-cell mdl-cell--6-col">
        <h4 class="mdl-cell mdl-cell--12-col">Nome do outro município</h4>
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <input #buscaMunicipio2 class="mdl-textfield__input" type="text" id="sample3" [(ngModel)]=query1 (keyup)=filter1()>
            <label class="mdl-textfield__label" for="sample3">Buscar município</label>
        </div>
        <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" (click)="getMunicipio2(buscaMunicipio2.value);">
            Buscar Município
        </button>
        <div class="suggestions" *ngIf="filteredList1.length > 0">
            <ul *ngFor="let item of filteredList1">
                <li>
                    <a (click)="select1(item.nome)">{{item.nome}}</a>
                </li>
            </ul>
        </div>

        <div class="mdl-cell mdl-cell--12-col">
            <div id="detalhes-municipio" *ngIf="municipio2" class="mdl-cell mdl-cell--12-col">
                <div class="mdl-card card-left mdl-shadow--2dp mdl-cell mdl-cell--12-col">
                    <div class="mdl-card__title mdl-card--border">
                        <h2 class="mdl-card__title-text">Mapa da Região - {{municipio2.nome}}</h2>
                    </div>
                    <div class="mdl-card__supporting-text">
                        <sebm-google-map [latitude]="municipio2.latitude" [longitude]="municipio2.longitude" [zoom]="zoom">
                            <sebm-google-map-marker *ngFor="let m2 of markers2" [latitude]="m2.lat" [longitude]="m2.lng" [label]="m2.label">
                            </sebm-google-map-marker>
                        </sebm-google-map>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="mdl-card card-left mdl-shadow--2dp mdl-cell mdl-cell--12-col">
        <div class="mdl-card__title mdl-card--border">
            <h2 class="mdl-card__title-text">Escolha os parâmetros para visualização do comparativo de dados.</h2>
        </div>
        <div class="mdl-card__supporting-text">
            <div class="mdl-cell--4-col">
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                    <input #buscaAno class="mdl-textfield__input" type="text" id="sample3" [(ngModel)]=queryAno (keyup)=filterAno()>
                    <label class="mdl-textfield__label" for="sample3">Ano</label>
                </div>
                <div class="suggestions" *ngIf="filteredListAno.length > 0">
                    <ul *ngFor="let ano of filteredListAno">
                        <li>
                            <a (click)="selectAno(ano.ano)">{{ano.ano}}</a>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="mdl-cell--4-col">
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" style="margin-right: 40px;">
                    <input #buscaTipoEnsino class="mdl-textfield__input" type="text" id="sample3" [(ngModel)]=queryTipoEnsino (keyup)=filterTipoEnsino()>
                    <label class="mdl-textfield__label" for="sample3">Tipo de Ensino</label>
                </div>
                <div class="suggestions" *ngIf="filteredListTipoEnsino.length > 0">
                    <ul *ngFor="let tipoEnsino of filteredListTipoEnsino">
                        <li>
                            <a (click)="selectTipoEnsino(tipoEnsino.nome)">{{tipoEnsino.nome}}</a>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="mdl-cell--4-col">
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                    <input #buscaCategoria class="mdl-textfield__input" type="text" id="sample3" [(ngModel)]=queryCategoria (keyup)=filterCategoria()>
                    <label class="mdl-textfield__label" for="sample3">Categoria</label>
                </div>
                <div class="suggestions" *ngIf="filteredListCategoria.length > 0">
                    <ul *ngFor="let categoria of filteredListCategoria">
                        <li>
                            <a (click)="selectCategoria(categoria.nome)">{{categoria.nome}}</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="mdl-cell mdl-cell--2-col">
            <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" (click)="buscarDados(buscaAno.value, buscaTipoEnsino.value, buscaCategoria.value);">
                Buscar Dados
            </button>
        </div>
    </div>

    <div *ngIf="tabelaDados1 && tabelaDados2" class="mdl-card card-left mdl-shadow--2dp mdl-cell mdl-cell--6-col">
        <div class="mdl-card__title mdl-card--border">
            <h2 class="mdl-card__title-text">Dados de {{tabelaDados1.Municipio}} sobre {{tabelaDados1.Categoria}} do ano {{tabelaDados1.Data}}</h2>
        </div>
        <table class="mdl-data-table mdl-js-data-table mdl-cell mdl-cell--6-col">
            <thead>
                <tr>
                    <th>Ano</th>
                    <th>Categoria</th>
                    <th>Tipo de Ensino</th>
                    <th>Subcategoria</th>
                    <th>Valor</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let dado of tabelaDados1.Subcategoria">
                    <td>{{tabelaDados1.Data}}</td>
                    <td>{{tabelaDados1.Categoria}}</td>
                    <td>{{tabelaDados1.TipoEnsino}}</td>
                    <td>{{dado.Subcategoria}}</td>
                    <td>{{dado.Valor}}</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div *ngIf="tabelaDados1 && tabelaDados2" class="mdl-card card-left mdl-shadow--2dp mdl-cell mdl-cell--6-col">
        <div class="mdl-card__title mdl-card--border">
            <h2 class="mdl-card__title-text">Dados de {{tabelaDados2.Municipio}} sobre {{tabelaDados2.Categoria}} do ano {{tabelaDados2.Data}}</h2>
        </div>
        <table class="mdl-data-table mdl-js-data-table mdl-cell mdl-cell--6-col">
            <thead>
                <tr>
                    <th>Ano</th>
                    <th>Categoria</th>
                    <th>Tipo de Ensino</th>
                    <th>Subcategoria</th>
                    <th>Valor</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let dado of tabelaDados2.Subcategoria">
                    <td>{{tabelaDados2.Data}}</td>
                    <td>{{tabelaDados2.Categoria}}</td>
                    <td>{{tabelaDados2.TipoEnsino}}</td>
                    <td>{{dado.Subcategoria}}</td>
                    <td>{{dado.Valor}}</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<div id="loader" *ngIf="isLoading">
    <img src="app/images/loading.gif" class="ajax-loader" />
</div>